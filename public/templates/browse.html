<script type="text/template"
        route="^browse"
        page-title="Browse Music"
        transform="transformBrowseMusic">
    {{#data}}
    <div class="container">
        <div source="$endpoint/catalog/browse/filters"
             template="browse-filters">
        </div>
        <div source="$endpoint/catalog/browse?{{query}}"
             template="music-browse">
        </div>
    </div>
    {{/data}}
</script>

<script type="text/template"
        template-name="browse-filters"
        completed="completedBrowseMusic">
    {{#loading}}{{>loading-view}}{{/loading}}
    {{#error}}<p>{{message}}</p>{{/error}}
    {{#data}}
    <ul role="filters-list" data-set="browse-filters"></ul>
    Add Filters: 
    <select name="genre" onchange="addBrowseFilter(null, this)">
        <option value="">Genre</option>
        {{#genres}}
        <option value="{{name}}">{{name}}</option>
        {{/genres}}
    </select>
    <select name="tag" onchange="addBrowseFilter(null, this)">
        <option value="">Tag</option>
        {{#tags}}
        <option>{{.}}</option>
        {{/tags}}
    </select>
    <select name="type" onchange="addBrowseFilter(null, this)">
        <option value="">Release Type</option>
        {{#types}}
        <option>{{.}}</option>
        {{/types}}
    </select>
    <button action="filterBrowseMusic" data-set-target="browse-filters">Filter</button>
    {{/data}}
</script>

<script type="text/template" template-name="browse-filter-item">
    <li>
        <input type="hidden" name="{{type}}s" value="{{value}}"/>
        <label>
            <span>{{type}}: </span>
            <span>{{value}}</span>
        </label>
        <button class="faux" action="removeBrowseFilter">
            <i class="fa fa-trash-o"></i>
        </button>
    </li>
</script>

<script type="text/template"
        template-name="music-browse"
        transform="transformMusicBrowseResults">
    {{#loading}}
    {{>loading-view}}
    {{/loading}}
    {{#error}}
    <p>{{message}}</p>
    {{/error}}
    {{#data}}
    <ul>
        {{#results}}
        <li>
            <a href="/release/{{catalogId}}">{{title}}</a>
            <label>{{artists}}</label>
            <label>{{type}}</label>
            <label>
                {{#preReleaseDate}}Pre-Released {{preReleaseDate}}{{/preReleaseDate}}
                {{#releaseDate}}Released {{releaseDate}}{{/releaseDate}}
            </label>
            <img src="{{cover}}" />
            <table>
                <tbody>
                    {{#tracks}}
                    <tr>
                        <td class="shrink">{{>playSong}}</td>
                        {{>trackCells}}
                        <td>
                            {{>trackButtons}}
                            {{#canPlaylist}}
                            <select
                                onchange="addToPlaylist(null, this)"
                                source="$endpoint/playlist"
                                template="select-playlist"
                                track-id="{{_id}}">
                            </select>
                            {{/canPlaylist}}
                        </td>
                    </tr>
                    {{/tracks}}
                </tbody>
            </table>
        </li>
        {{/results}}
    </ul>
    {{^total}}
    <div>No results found.</div>
    {{/total}}
    {{/data}}
</script>
